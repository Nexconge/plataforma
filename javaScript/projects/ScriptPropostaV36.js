// Se não foi, ela baixa o HTML, injeta na página e configura os eventos.
async function garantirEstruturaModal(username) {
    // Se o modal já existe, não fazemos nada e retornamos imediatamente.
    if (document.getElementById('modalProposta')) {
        return;
    }

    // Baixa o HTML do modal. 'await' pausa a execução até o fetch terminar.
    const response = await fetch('https://cdn.jsdelivr.net/gh/nexconge/plataforma@developer/html/menuPropostaV05.html');
    if (!response.ok) throw new Error('Não foi possível baixar o HTML do modal.');
    const html = await response.text();

    // Injeta o HTML no container.
    const modalContainer = document.getElementById('modal-container');
    if (!modalContainer) throw new Error("Container com id 'modal-container' não foi encontrado.");
    modalContainer.innerHTML = html;

    // Configura os eventos internos do modal (fechar, submit).
    configurarEventosDoModal(username);
}

// Configura os eventos que são parte do modal (fechar, submeter formulário)
function configurarEventosDoModal(username) {
    const modal = document.getElementById('modalProposta');
    const btnFecharModal = document.getElementById('closeModal');
    const formProposta = document.getElementById('formProposta');
    const header = document.getElementById('pageHeader');
    const sideToggle2 = document.getElementById('sideToggleGroup');

    if (!modal || !btnFecharModal || !formProposta) {
        console.error("Não foi possível encontrar um ou mais elementos essenciais do modal (modalProposta, closeModal, formProposta).");
        return;
    }

    // Evento para o botão de fechar
    btnFecharModal.addEventListener('click', () => {
        modal.style.display = 'none';
        header.style.display = 'flex';
        sideToggle2.style.display = 'flex';
    });

    // Evento para fechar clicando fora do modal
    window.addEventListener('click', (e) => {
        if (e.target == modal) {
            modal.style.display = 'none';
            header.style.display = 'flex';
            sideToggle2.style.display = 'flex';
        }
    });

    // Evento para o envio do formulário, que chama a geração do PDF
    formProposta.addEventListener('submit', (e) => {
        e.preventDefault();
        console.log("Botão de gerar proposta clicado")
        gerarProposta(username); // Chamando a função de gerar PDF
    });

    // Evento de mascara do campo de CPF
    const cpfInput = document.getElementById("propClienteCPF");
    cpfInput.addEventListener('input', function () {
        let valor = this.value.replace(/\D/g, ''); // só números
        //Limita a 14 caracteres (CNPJ)
        if (valor.length > 14) {
            valor = valor.substring(0, 14);
        }
        //Aplica a mascara
        if (valor.length <= 11) {
            // CPF: 000.000.000-00
            valor = valor.replace(/(\d{3})(\d)/, "$1.$2");
            valor = valor.replace(/(\d{3})(\d)/, "$1.$2");
            valor = valor.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
        } else {
            // CNPJ: 00.000.000/0000-00
            valor = valor.replace(/^(\d{2})(\d)/, "$1.$2");
            valor = valor.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
            valor = valor.replace(/\.(\d{3})(\d)/, ".$1/$2");
            valor = valor.replace(/(\d{4})(\d)/, "$1-$2");
        }
        this.value = valor;
    });

    // Evento de mascara do campo de telefone
    const telefoneInput = document.getElementById("propClienteTelefone");
    telefoneInput.addEventListener("input", () => {
        let value = telefoneInput.value;
        value = value.replace(/\D/g, ""); // Remove tudo que não for número
        value = value.replace(/^(\d{2})(\d)/, '($1) $2'); // Aplica a máscara: (xx) xxxxx-xxxx
        value = value.replace(/(\d{5})(\d)/, '$1-$2');
        telefoneInput.value = value;
    });
}


// --- PARTE 2: FUNÇÃO PRINCIPAL (chamada pelo Bubble) ---
// Esta é a função que o botão do Bubble vai chamar.
// Ela verifica se um lote foi selecionado, preenche os dados e MOSTRA o modal.
export async function abrirEPreencherModalProposta(mapaManager, username) {

    try {

        if (typeof mapaManager === 'undefined' || !mapaManager.selectedLoteId) {
            alert("Por favor, selecione um lote no mapa primeiro!");
            return;
        }
        const loteSelecionado = mapaManager.polygons[mapaManager.selectedLoteId].loteData;

        //Verifica se o lote selecionado está disponível
        if (loteSelecionado.Status !== "Disponível") {
            alert("O lote selecionado não está disponível para venda. Por favor, escolha outro lote.");
            return;
        }

        //Baixa o HTML do modal, se necessário, e injeta na página
        await garantirEstruturaModal(username);

        // Agora que temos 100% de certeza que o modal existe no DOM, podemos continuar.
        const modal = document.getElementById('modalProposta');
        const header = document.getElementById('pageHeader');
        const sideToggle2 = document.getElementById('sideToggle');

        const formatadorDeMoeda = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });
        const match = loteSelecionado.Nome.match(/^Q(\d+)([A-Z]+)(\d+)$/); //Ragex para encontrar o primeiro conjunto de letras depois de Q para definir o numero do lote.
        if (match) {
            document.getElementById('propQuadraNome').textContent = match[1] || 'N/A'; // Quadra
            document.getElementById('propLoteNome').textContent = match[3] || 'N/A';   // Lote
        } else {
            document.getElementById('propQuadraNome').textContent = 'N/A';
            document.getElementById('propLoteNome').textContent = 'N/A';
        }

        document.getElementById('propLoteArea').textContent = (loteSelecionado.Área || '0').toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        document.getElementById('propLoteValor').textContent = formatadorDeMoeda.format(loteSelecionado.Valor) || 0;

        // Passo D: Preenche os dados da condição financeira.
        const finValorEntrada = loteSelecionado.Valor * 0.25;
        const finValorParcela = loteSelecionado.Valor * 0.012;
        const finValorReforco = (loteSelecionado.Valor - finValorEntrada - finValorParcela * 48) / 4;
        document.getElementById('propValorEntrada').value = formatadorDeMoeda.format(finValorEntrada);
        document.getElementById('propValorEntrada').disabled = true;
        document.getElementById('propQtdeParcelas').value = 48;
        document.getElementById('propQtdeParcelas').disabled = true;
        document.getElementById('propValorParcela').value = formatadorDeMoeda.format(finValorParcela);
        document.getElementById('propValorParcela').disabled = true;
        document.getElementById('propQtdeReforcos').value = 4;
        document.getElementById('propQtdeReforcos').disabled = true;
        document.getElementById('propValorReforco').value = formatadorDeMoeda.format(finValorReforco);
        document.getElementById('propValorReforco').disabled = true;

        // Passo E: mostra o modal e esconde o header e sideToggle
        modal.style.display = 'flex';
        header.style.display = 'none';
        sideToggle2.style.display = 'none';

    } catch (error) {
        console.error("Falha ao abrir o modal da proposta:", error);
    }
}

function parseBR(valor) {
    if (!valor) return 0;
    return parseFloat(
        valor
            .toString()
            .replace(/[^\d,.-]/g, '') // remove R$, espaços e caracteres não numéricos
            .replace(/\./g, '')       // remove pontos de milhar
            .replace(',', '.')        // troca vírgula decimal por ponto
    ) || 0;
}
function formatDateStr(dataStr) {
    if (!dataStr) return '';
    const [ano, mes, dia] = dataStr.split('-');
    return `${dia}/${mes}/${ano}`;
}

/**
 * Função auxiliar para carregar uma imagem de forma assíncrona.
 * Retorna uma Promise que resolve com o objeto da imagem quando carregado.
 * @param {string} url - A URL da imagem a ser carregada.
 * @returns {Promise<HTMLImageElement>}
 */
function carregarImagem(url) {
    return new Promise((resolve, reject) => {
        const img = new Image();
        // Essencial para carregar imagens de outros domínios (CORS)
        img.crossOrigin = "Anonymous"; 
        // A Promise resolve quando a imagem termina de carregar
        img.onload = () => resolve(img);
        // A Promise rejeita se houver um erro no carregamento
        img.onerror = (err) => reject(err);
        // Inicia o download da imagem
        img.src = url;
    });
}
/**
 * Função principal para gerar a proposta em PDF.
 * @param {string} username - Nome do corretor/usuário.
 */
async function gerarProposta(username) {
    const { jsPDF } = window.jspdf;

    // Captura os dados do formulário
    const dados = {
        // Lote
        quadra: document.getElementById('propQuadraNome')?.textContent || '',
        lote: document.getElementById('propLoteNome')?.textContent || '',
        area: parseBR(document.getElementById('propLoteArea')?.textContent),
        valorTotal: parseBR(document.getElementById('propLoteValor')?.textContent),
        valorMetroQuadrado: (
            parseBR(document.getElementById('propLoteValor')?.textContent) /
            parseBR(document.getElementById('propLoteArea')?.textContent)
        ) || 0,

        // Cliente
        nomeCliente: document.getElementById('propClienteNome').value || '',
        cpfCliente: document.getElementById('propClienteCPF').value || '',
        emailCliente: document.getElementById('propClienteEmail').value || '',
        telefoneCliente: document.getElementById('propClienteTelefone').value || '',
        profissaoCliente: document.getElementById('propClienteProfissao')?.value || '',
        estadoCivilCliente: document.getElementById('propClienteEstadoCivil')?.value || '',
        enderecoCliente: document.getElementById('propClienteEndereco')?.value || '',
        cidadeCliente: document.getElementById('propClienteCidade')?.value || '',

        // Financeiro
        finValorEntrada: parseFloat(document.getElementById('propValorEntrada')?.value.replace(/[^\d,.-]/g, '').replace('.', '').replace(',', '.')) || 0,
        finDataEntrada: document.getElementById('propDataEntrada').value || '',
        finQntParcela: parseInt(document.getElementById('propQtdeParcelas').value) || 0,
        finValorParcela: parseFloat(document.getElementById('propValorParcela')?.value.replace(/[^\d,.-]/g, '').replace('.', '').replace(',', '.')) || 0,
        finDataParcela: document.getElementById('propDataPrimeiraParcela').value || '',
        finQntReforco: parseInt(document.getElementById('propQtdeReforcos').value) || 0,
        finValorReforco: parseFloat(document.getElementById('propValorReforco')?.value.replace(/[^\d,.-]/g, '').replace('.', '').replace(',', '.')) || 0,
        finDataReforco: document.getElementById('propDataPrimeiroReforco').value || ''
    };

    // Validação: todos os campos obrigatórios
    const obrigatorios = [
        'quadra', 'lote', 'area', 'valorTotal',
        'nomeCliente', 'cpfCliente', 'emailCliente', 'telefoneCliente',
        'profissaoCliente', 'estadoCivilCliente', 'enderecoCliente', 'cidadeCliente',
        'finValorEntrada', 'finDataEntrada', 'finQntParcela', 'finValorParcela',
        'finDataParcela', 'finQntReforco', 'finValorReforco', 'finDataReforco'
    ];
    let faltando = obrigatorios.filter(campo => {
        const valor = dados[campo];
        return (
            valor === '' || valor === null ||
            valor === 'dd/mm/aaaa' || valor === "Invalid Date" || // máscara não preenchida
            (typeof valor === 'number' && (isNaN(valor) || valor <= 0))
        );
    });
    if (faltando.length > 0) {
        alert("⚠️ Preencha todos os campos obrigatórios antes de gerar a proposta!");
        return; // interrompe a função
    }

    console.log("Dados coletados e campos validados, iniciando construção do pdf.");

    // ----------------------------
    // Geração do PDF
    const doc = new jsPDF({ unit: 'mm', format: 'a4', orientation: 'portrait' });
    let yAtual;
    let startX;
    let endX;
    const hoje = new Date();

    console.log("criado objeto jsPDF.");

    try {
        console.log("Adicionando imagem do timbrado via Base64...");
        const timbradoBase64 = "data:image/jpeg;base64,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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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RPHE/lz+LIDmbYTkYnOenm7anPGTPmx1thz92HFTNM5vTnJaI82rafEzEx8eeffiUGPJiwdbjJGzGWtZ578lot57faZ9rcT459p4ZgTcyRYiMxntho6fUe/cw22I18Va93bemClO201mK2ntjniJmJ/RzaMuvo7WPc2Md5zdvp0jLXJM3i3M38TPHjmOfj3M0TXON2ptRnMbdPpu1r7U5uubt52otGWditLzk+zPMWivmZ449uHbBfHfS18WKtZvgm/qR9ajFxfu5i/nxPjiOY/u/kxxYuSzNiMREdsefVt4c0Z82aZthmk7Vsndj2fSvjn+/WbcRMT+Xjj4c+crPhmsTmrki+O2W9K258244nnj9YQnM8RXmeI88JVXqjdqi3onaW9Xay9tcf1jX/hvoRSazandx28zHH3u7u/Tn8FfQ6jTW1vrOfFr5c2v9jVm3PqVt7xMxE8dteefMT54iPjxkjXNnOYY/L04xPn992xpbW3i1MFem7GCkxa188ZbUie/nxP2vh28e3x5RZqa25XPraeXHX0tm+TDW1u2L47cR4m3y7Y8T58swTmZjEryYidUdfOvq1KZPquXU19bcxUzYq5LWyTMWpW9on7PPmJ8REc+3My428l/qlK9SzVz5ozRNe3LW14x8T3RNo595445544nx88wNe2F5W8Sszm0qTW+vrZ63raLc3zRaPH4RWP816MOLF1OeqRtYp1qZZ2KT6lZvbz3RXt55554j28e/syBIrx1Wq3npLa1NjY+q6WLV2damHH3evTLasR3TeeZtE+bR29vtz7fNWvjxbut6WpkpWcOfJNaZLxTnHbjiYm0xEzHHn9GcLNzMYlIs4nVE+fH91rqE46/V9bHkrk+r4Ypa1Z5rNpta0xE/Hju45/BVBiZzOXSmnTGABGgAAAAAAAAAAAAAAAAAAAAAGl06tPqs27q5LTl+1ivselSsREcWmOYmfefafHH4p9rNjzZurUw7GOfVvGSkxfiLxFuZ4mZ8+/5sYdIuYjDhNnNWrPmYn+HoJ2cHrU3MGPDOKuGtft7PEREU4mk09/fmOIjz7/iq4dzsy9Gr9ZiKYojvjv8U5zXmefl449/gyRZuykcPTEY86TH8tOYybGnr49LYx09Gb+pWctccxbumYv5mOfHEc/DtXcu1gnqE5LbeLJ/telackWiItFaWi1vyiff5PPhFzCzYie/kzlo4t3Lbpm9XJtWnJlzYrcTfzb73dP+XP6LGLZxZMmatslb5cuthrEzl7O7ite6vd8J8R7/AC4YwkXJjz5+6zYpnPnp7Nmdr0bxWLY8V8erlpE1z98xzzxXu9uffiI+br07bx1ydLvm2KxOLYvFptb7tOazHPyjmbfzZAvNnOfO3snIiYx5392nSmS+hbSxZ8dc9c83yxOasepXtjt4tzxPExbxz/aT+pW+TJHq+rmx6daZcmOeZtxeO/ifjMU8c/KJYrtiy5MOSuXDe1L0nmtqzxMSkXME2c9/PZvReeclqZum45x5qW1ppbHWfTiZ58x54445i3mf3R4d7T18U7+vl/rdW9sOHHb3titfmP8A+M5In84ZObczZ69mSuHjnnmuGlZn9YiJQtTd9GKeGzH6mzfLrau/g1dbYpODDTJb1It4tN4mff58dkfnCtjp9b6ZTBjy44y4s972jJkiv2bVrET5nz92WeMzcz288h0izjGJ3/v3am/sVrTexYdmtq5NuJ+xbxesRbz+MeVzYvlv1TX3adSw/V8WPDzb1o+xEUjur288z8fER55/N58XmszYjtPm3s2um2w0jXy1tSaRmm9oy7XZXD5jz2xMWmeIiefj7fBHv7fZXDXV2YiKbOa8Rjv7fajifH4ezJE5n6cQsWI1apnzf3bt9nHjzY/qubW5rubcxFr8Vmlq0iPMe0THMRPj8/DrW+LVy99dmcdvqmesY5zxf05mJ4ito+fPt7sQXm98J+XjGM+b+6/G9njT1Mf1q0Tiz3mI7/NY4pMT+/d/Nc3pxbEbOt03NhpNd7NeYjLWkZMczHZMTMxExHFv3YgnMnGJamzGYmF7qP8AX5e76xjyXw4KRlv3x9u3iPH96YiYjx79sysbfq5tjJt6u7jxa04uKROaImtO3j0+335+Ht+Pt5ZImvqvK6b9GtPq7H1PLo7mPBTDjrWe7NFJxXj71uOefM/a8RPvx7+HTe3aTr/7FlnHS29ny1pWeJivFO2ePh8eP1Zgs3JxhIsxExM9mv1Hbrl3usduxW+PJM+nxfmtojLXjt+fjn2+HLjSrenTd/TxbuDHlvkwTFfViPUrEX5iJ9vjHP7MkOZ+rV5unJiKNET6fTHs3NfYjWthpm2qfWMWrtR3xkie3nHbsp3RPHPPPt/eiGHMzM8zPMyCVV6ow3RbiiZnzv7gDDoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//9k="
        doc.addImage(timbradoBase64, 'PNG', 0, 0, 210, 297);
        console.log("Imagem do timbrado adicionada com sucesso.");

        // Título
        doc.setFontSize(18).setFont('helvetica', 'bold');
        doc.text('Proposta Comercial', 105, 30, { align: 'center' });
        doc.setFontSize(12).setFont('helvetica', 'normal');
        yAtual = 50;


        // ----------------------------
        // Seção: Dados do Lote
        doc.setFontSize(14).setFont('helvetica', 'bold');
        doc.text('Dados Lote', 20, yAtual);
        doc.setFontSize(10).setFont('helvetica', 'normal');
        yAtual += 2; startX = 20; endX = 190;
        doc.line(startX, yAtual, endX, yAtual);
        yAtual += 8;

        const colEsquerda = [
            `Quadra: ${dados.quadra || '---'}`,
            `Lote: ${dados.lote || '---'}`,
            `Área: ${dados.area.toLocaleString('pt-BR', { minimumFractionDigits: 2 })} m²`
        ];

        const colDireita = [
            `Valor Total: ${dados.valorTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`,
            `Valor m²: ${dados.valorMetroQuadrado.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`
        ];

        colEsquerda.forEach((linha, i) => doc.text(linha, 20, yAtual + i * 8));
        colDireita.forEach((linha, i) => doc.text(linha, 105, yAtual + i * 8));
        yAtual += 32;


        // ----------------------------
        // Seção: Dados Cliente
        doc.setFontSize(14).setFont('helvetica', 'bold');
        doc.text('Dados Cliente', 20, yAtual);
        doc.setFontSize(10).setFont('helvetica', 'normal');
        yAtual += 2; doc.line(20, yAtual, 190, yAtual);
        yAtual += 8;

        const colCliEsq = [
            `Nome: ${dados.nomeCliente}`,
            `CPF: ${dados.cpfCliente}`,
            `Telefone: ${dados.telefoneCliente}`,
            `Email: ${dados.emailCliente}`
        ];
        const colCliDir = [
            `Profissão: ${dados.profissaoCliente}`,
            `Estado Civil: ${dados.estadoCivilCliente}`,
            `Endereço: ${dados.enderecoCliente}`,
            `Cidade/UF: ${dados.cidadeCliente}`
        ];

        colCliEsq.forEach((linha, i) => doc.text(linha, 20, yAtual + i * 8));
        colCliDir.forEach((linha, i) => doc.text(linha, 105, yAtual + i * 8));
        yAtual += 40;


        // ----------------------------
        // Seção: Condição Financeira
        doc.setFontSize(14).setFont('helvetica', 'bold');
        doc.text('Condição Financeira', 20, yAtual);
        doc.setFontSize(10).setFont('helvetica', 'normal');
        yAtual += 2; doc.line(20, yAtual, 190, yAtual);
        yAtual += 8;

        doc.text(`Entrada: ${dados.finValorEntrada.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`, 20, yAtual); yAtual += 8;
        doc.text(`Data de Vencimento Entrada: ${formatDateStr(dados.finDataEntrada)}`, 20, yAtual); yAtual += 8;
        doc.text(`Quantidade Parcelas: ${dados.finQntParcela}`, 20, yAtual); yAtual += 8;
        doc.text(`Valor Parcelas: ${dados.finValorParcela.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`, 20, yAtual); yAtual += 8;
        doc.text(`Data de Vencimento 1ª Parcela: ${formatDateStr(dados.finDataParcela)}`, 20, yAtual); yAtual += 8;
        doc.text(`Quantidade Reforços: ${dados.finQntReforco}`, 20, yAtual); yAtual += 8;
        doc.text(`Valor Reforços: ${dados.finValorReforco.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}`, 20, yAtual); yAtual += 8;
        doc.text(`Data de Vencimento 1º Reforço: ${formatDateStr(dados.finDataReforco)}`, 20, yAtual); yAtual += 16;

        // Assinaturas
        doc.text(`Chapecó, ${hoje.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' })}.`, 190, yAtual, { align: 'right' });
        yAtual += 28;

        doc.line(32, yAtual, 92, yAtual);
        doc.line(118, yAtual, 178, yAtual);

        doc.setFontSize(10);
        doc.text(username, 62, yAtual + 5, { align: 'center' });
        doc.text("Corretor", 62, yAtual + 10, { align: 'center' });
        doc.text(dados.nomeCliente, 148, yAtual + 5, { align: 'center' });
        doc.text("Cliente", 148, yAtual + 10, { align: 'center' });

        console.log("primeira página construída, iniciando a segunda página.")

        // ----------------------------
        // Segunda Página - Termo de Intenção de Compra
        doc.addPage();
        // doc.addImage(timbrado, 'PNG', 0, 0, 210, 297); // Se quiser o timbrado na segunda página, adicione aqui também

        // Adicionar título
        doc.setFontSize(18);
        doc.setFont('helvetica', 'bold')
        doc.text('Termo de Intenção de Compra', 105, 30, { align: 'center' });
        doc.setFontSize(10);
        doc.setFont('helvetica', 'normal')
        yAtual = 50;

        const longText = `        Pelo presente termo e na melhor forma de direito o Sr(a). ${dados.nomeCliente}, brasileiro, ${dados.estadoCivilCliente}, inscrito sob CPF nº ${dados.cpfCliente}, ${dados.profissaoCliente}, Residente e domiciliado em ${dados.enderecoCliente}, no Município de ${dados.cidadeCliente}.
         Formaliza através da WF SOLUÇÕES IMOBILIÁRIAS LTDA, empresa Jurídica de direito privado, inscrita no CNPJ 53.265.298/0001-28, neste ato representada por seus Sócios Procuradores Sr. Marcos Aurelio Fortes dos Santos, brasileiro, casado, empresário, inscrito sob nº CPF 006.614.829-44, cédula de identidade nº RG 3.848.767 SSP/SC, CRECI-SC 23.076F, e/ou José Eduardo Bevilaqua, brasileiro, solteiro, empresário, inscrito sob nº CPF 061.248.209-00, cédula de identidade nº RG 4.936.776 SSP/SC, CRECI-SC 63.226F, a Proposta de Intenção de Compra do imóvel abaixo descrito, Sendo:
         Lote urbano com ${dados.area} metros de área, localizado da quadra nº ${dados.quadra}, lote nº ${dados.lote}, sito no Município e Comarca de Chapeco/SC, inserido no empreendimento denominado “ORIGENS”.
         Ofereço para compra do imóvel mencionado acima o valor de R$ ${dados.valorMetroQuadrado} (um mil e quatrocentos reais) pelo metro quadrado. Me comprometo ainda a realizar os pagamentos da seguinte forma: 25% (vinte e cinco por cento) do valor total do imóvel pago em moeda corrente nacional no dia de assinatura do contrato de compra e venda, valendo este como entrada e o saldo dividido em 48 (quarenta e oito) parcelas mensais fixas e sucessivas. Com vencimento da primeiro 30 (trinta) dias após a assinatura do referido contrato de compra e venda.
         Caso essa proposta seja aceita, assumo desde já o compromisso de fornecer todos os documentos necessários para formalização da negociação dentro de um prazo máximo de 05 (cinco) dias.
    `;

        doc.text(longText, 20, yAtual, { align: "justify", maxWidth: 170, lineHeightFactor: 2.5 })

        yAtual = 230
        doc.text(`Chapecó, ${hoje.toLocaleDateString('pt-BR', { day: '2-digit', month: 'long', year: 'numeric' })}.`, 190, yAtual, { align: 'right' });
        yAtual += 20;

        // Define posição, tamanho e desenha as linhas
        startX = 75;
        endX = 135;
        doc.line(startX, yAtual, endX, yAtual);
        yAtual += 5;

        // Inclui Nome e Qualificação
        doc.setFontSize(10);
        doc.text(dados.nomeCliente, 105, yAtual, { align: 'center' });
        doc.text("Cliente", 105, yAtual + 5, { align: 'center' });

        console.log("pdf pronto para ser exportado")

    } catch (error) {
        // Bloco de erro caso a imagem não carregue
        console.error("Erro ao carregar a imagem do timbrado:", error);
        alert("⚠️ Ocorreu um erro ao carregar os recursos para o PDF. Verifique sua conexão e tente novamente.");
        return; // Interrompe a função
    }

    // ----------------------------
    // Exporta

    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
        console.log("Lógica para iOS/Mobile ativada.");
        const dataUriString = doc.output('datauristring');
        window.open(dataUriString, "_blank");
    } else {
        console.log("Lógica para Desktop ativada (download direto).");
        doc.save(`Proposta_${dados.quadra}_${dados.lote}.pdf`);
    }

    console.log("Processo finalizado.");
}

// Expõe a função principal para o Bubble, tornando-a "global"
// O nome que o Bubble vai chamar é "abrirModalProposta"
window.abrirModalProposta = abrirEPreencherModalProposta;